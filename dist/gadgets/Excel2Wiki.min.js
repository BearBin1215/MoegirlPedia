(()=>{"use strict";var e={5163:function(e,t,n){n.d(t,{Z:()=>A});var o=n(9415),i=n.n(o),r=n(3018),a=n.n(r)()(i());a.push([e.id,"#excel-to-wiki{z-index:200;background:#ffffffde;border:1px solid #ccc;width:20em;max-width:84vw;max-height:50em;padding:.8em;position:fixed;top:8px;left:8px;box-shadow:0 0 6px #ccc}#excel-to-wiki #e2w-close{cursor:pointer;background:0;border:0;width:1em;height:1em;padding:0;font-size:1.5em;font-weight:700;position:absolute;top:0;right:0}#excel-to-wiki #e2w-panel{flex-direction:column;height:100%;display:flex}#excel-to-wiki #e2w-panel #e2w-input,#excel-to-wiki #e2w-panel #e2w-output{border:1px solid #aaa;flex:1 0;min-height:5em;max-height:15em;padding:.2em;overflow:auto}#excel-to-wiki #e2w-panel #e2w-input table{border-collapse:collapse}#excel-to-wiki #e2w-panel #e2w-input td{text-align:left;border:1px solid #bbb}#excel-to-wiki #e2w-panel #e2w-copy{margin-left:.3em;font-size:.8em;font-weight:400}#excel-to-wiki #e2w-panel #e2w-usedouble{margin-top:0}","",{version:3,sources:["webpack://./src/gadgets/Excel2Wiki/index.less"],names:[],mappings:"AADA,eAAA,WAAA,CAAA,oBAAA,CAAA,qBAAA,CAAA,UAAA,CAAA,cAAA,CAAA,eAAA,CAAA,YAAA,CAAA,cAAA,CAAA,OAAA,CAAA,QAAA,CAAA,uBAAA,CAaA,0BAAA,cAAA,CAAA,YAAA,CAAA,QAAA,CAAA,SAAA,CAAA,UAAA,CAAA,SAAA,CAAA,eAAA,CAAA,eAAA,CAAA,iBAAA,CAAA,KAAA,CAAA,OAAA,CAaA,0BAAA,qBAAA,CAAA,WAAA,CAAA,YAAA,CAKA,2EAAA,qBAAA,CAAA,QAAA,CAAA,cAAA,CAAA,eAAA,CAAA,YAAA,CAAA,aAAA,CASA,2CAAA,wBAAA,CAGA,wCAAA,eAAA,CAAA,qBAAA,CAIA,oCAAA,gBAAA,CAAA,cAAA,CAAA,eAAA,CAKA,yCAAA,YAAA",sourcesContent:["#excel-to-wiki {\n  position: fixed;\n  top: 8px;\n  left: 8px;\n  width: 20em;\n  max-width: 84vw;\n  max-height: 50em;\n  padding: 0.8em;\n  z-index: 200;\n  border: 1px solid #ccc;\n  box-shadow: 0 0 6px #ccc;\n  background: rgba(255, 255, 255, 0.87);\n}\n#excel-to-wiki #e2w-close {\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 1em;\n  height: 1em;\n  padding: 0;\n  font-size: 1.5em;\n  font-weight: bold;\n  border: 0;\n  background: 0;\n  cursor: pointer;\n}\n#excel-to-wiki #e2w-panel {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n#excel-to-wiki #e2w-panel #e2w-input,\n#excel-to-wiki #e2w-panel #e2w-output {\n  border: 1px solid #aaa;\n  flex: 1 0;\n  padding: 0.2em;\n  min-height: 5em;\n  max-height: 15em;\n  overflow: auto;\n}\n#excel-to-wiki #e2w-panel #e2w-input table {\n  border-collapse: collapse;\n}\n#excel-to-wiki #e2w-panel #e2w-input td {\n  border: 1px solid #bbb;\n  text-align: left;\n}\n#excel-to-wiki #e2w-panel #e2w-copy {\n  font-size: 0.8em;\n  font-weight: normal;\n  margin-left: 0.3em;\n}\n#excel-to-wiki #e2w-panel #e2w-usedouble {\n  margin-top: 0;\n}\n"],sourceRoot:""}]);let A=a},3018:function(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,o,i,r){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(o)for(var A=0;A<this.length;A++){var c=this[A][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var s=[].concat(e[l]);o&&a[s[0]]||(void 0!==r&&(void 0===s[5]||(s[1]="@layer".concat(s[5].length>0?" ".concat(s[5]):""," {").concat(s[1],"}")),s[5]=r),n&&(s[2]&&(s[1]="@media ".concat(s[2]," {").concat(s[1],"}")),s[2]=n),i&&(s[4]?(s[1]="@supports (".concat(s[4],") {").concat(s[1],"}"),s[4]=i):s[4]="".concat(i)),t.push(s))}},t}},9415:function(e){e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(n))));return[t].concat(["/*# ".concat("sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o)," */")]).join("\n")}return[t].join("\n")}},85:function(e){var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var i={},r=[],a=0;a<e.length;a++){var A=e[a],c=o.base?A[0]+o.base:A[0],l=i[c]||0,s="".concat(c," ").concat(l);i[c]=l+1;var p=n(s),u={css:A[1],media:A[2],sourceMap:A[3],supports:A[4],layer:A[5]};if(-1!==p)t[p].references++,t[p].updater(u);else{var d=function(e,t){var n=t.domAPI(t);return n.update(e),function(t){t?(t.css!==e.css||t.media!==e.media||t.sourceMap!==e.sourceMap||t.supports!==e.supports||t.layer!==e.layer)&&n.update(e=t):n.remove()}}(u,o);o.byIndex=a,t.splice(a,0,{identifier:s,updater:d,references:1})}r.push(s)}return r}e.exports=function(e,i){var r=o(e=e||[],i=i||{});return function(e){e=e||[];for(var a=0;a<r.length;a++){var A=n(r[a]);t[A].references--}for(var c=o(e,i),l=0;l<r.length;l++){var s=n(r[l]);0===t[s].references&&(t[s].updater(),t.splice(s,1))}r=c}}},9931:function(e){var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},6300:function(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},7342:function(e,t,n){e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},1417:function(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){var o,i,r;o="",n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {")),(i=void 0!==n.layer)&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,i&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}"),(r=n.sourceMap)&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(o,t,e.options)},remove:function(){!function(e){if(null!==e.parentNode)e.parentNode.removeChild(e)}(t)}}}},1514:function(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={id:o,exports:{}};return e[o](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,n.rv=()=>"1.4.2",n.ruid="bundler=rspack@1.4.2",(()=>{var e=n(85),t=n.n(e),o=n(1417),i=n.n(o),r=n(9931),a=n.n(r),A=n(7342),c=n.n(A),l=n(6300),s=n.n(l),p=n(1514),u=n.n(p),d=n(5163),f={};f.styleTagTransform=u(),f.setAttributes=c(),f.insert=a().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=s(),t()(d.Z,f),d.Z&&d.Z.locals&&d.Z.locals,["edit","submit"].includes(mw.config.get("wgAction"))&&mw.loader.using("oojs-ui").done(()=>{let e=setInterval(()=>{if(!document.getElementById("wikiEditor-section-advanced"))return;clearInterval(e);let t="",n=new OO.ui.CheckboxInputWidget,o=new OO.ui.FieldLayout(n,{label:$("<span>同行使用<code>||</code></span>"),align:"inline",id:"e2w-usedouble"}),i=$('<div id="e2w-input" contenteditable="true"/>'),r=$('<div id="excel-to-wiki"/>').append('<button id="e2w-close" title="关闭">\xd7</button>',$('<div id="e2w-panel"/>').append("<h5>在此处粘贴表格</h5>",i,'<h5>输出<a id="e2w-copy">[复制]</a></h5>',o.$element,'<div id="e2w-output"/>')).appendTo($(document.body)).hide(),a=$('[rel="table"]'),A=a.clone();A.attr("rel","excel2wiki").children().attr("title","从Excel粘贴表格").on("click",e=>{e.preventDefault(),r.show()}).children(".oo-ui-icon-table").removeClass("oo-ui-icon-table").addClass("oo-ui-icon-tableCaption");let c=()=>{let e=i.get(0).firstElementChild;if(e?.tagName==="TABLE"){let o=n.isSelected(),i=[];e.querySelectorAll("tr").forEach(e=>{let t=[];e.querySelectorAll("td, th").forEach((e,n)=>{t.push((n>0&&o?" || ":"| ")+(e.colSpan>1?`colspan="${e.colSpan}" `:"")+(e.rowSpan>1?`rowspan="${e.rowSpan}" `:"")+(e.colSpan+e.rowSpan>2?"| ":"")+e.innerText)}),i.push(t.join(o?"":"<br>"))}),t=`{|<br>${i.join("<br>|-<br>")}<br>|}`,$("#e2w-output").html(t)}};$("#e2w-input").on("paste",async()=>{await new Promise(e=>setTimeout(e,30)),c()}),n.on("change",c),$("#e2w-close").on("click",()=>r.hide()),$("#e2w-copy").on("click",e=>{navigator.clipboard.writeText(t.replaceAll("<br>","\n")).then(()=>{$(e.target).text("[复制成功]"),setTimeout(()=>$(e.target).text("[复制]"),3e3)},t=>{$(e.target).text(`[\u{590D}\u{5236}\u{5931}\u{8D25}\u{FF1A}${t}]`),setTimeout(()=>$(e.target).text("[复制]"),3e3)})}),a.after(A)},500)})})()})();
//# sourceMappingURL=Excel2Wiki.min.js.map