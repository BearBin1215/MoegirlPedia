(()=>{"use strict";var e={879:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",a=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),a&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),a&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,a,r,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(a)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(s[c]=!0)}for(var l=0;l<e.length;l++){var p=[].concat(e[l]);a&&s[p[0]]||(void 0!==i&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=i),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),r&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=r):p[4]="".concat(r)),t.push(p))}},t}},246:e=>{e.exports=function(e){return e[1]}},115:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(246),r=n.n(a),i=n(879),s=n.n(i)()(r());s.push([e.id,".search-types{align-items:center;display:flex;float:none}#bearbintools-listenhancer-search{padding:.5em;-webkit-user-select:none;-moz-user-select:none;user-select:none}#bearbintools-listenhancer-search a{display:inline;padding:0}.listenhancer-search-edit{float:right;margin-left:.5em}",""]);const o=s},72:e=>{var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var i={},s=[],o=0;o<e.length;o++){var c=e[o],l=a.base?c[0]+a.base:c[0],p=i[l]||0,d="".concat(l," ").concat(p);i[l]=p+1;var u=n(d),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)t[u].references++,t[u].updater(m);else{var f=r(m,a);a.byIndex=o,t.splice(o,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function r(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var i=a(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var o=n(i[s]);t[o].references--}for(var c=a(e,r),l=0;l<i.length;l++){var p=n(i[l]);0===t[p].references&&(t[p].updater(),t.splice(p,1))}i=c}}},659:e=>{var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,r&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={id:a,exports:{}};return e[a](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,(()=>{const e=async(e,t)=>{const n=new mw.Api;let a="1";const r=[];for(;a;){const i={action:"query",prop:"transcludedin",titles:e,tilimit:"max",ticontinue:a};t&&(i.tinamespace=t);const s=await n.post(i);r.push(...(Object.values(s.query.pages)[0].transcludedin||[]).map((({title:e})=>e))),a=s.continue?.ticontinue}return r},t=async(e,t)=>{const n=new mw.Api;let a="1";const r=[];for(;a;){const i={action:"query",prop:"linkshere",titles:e,lhlimit:"max",lhcontinue:a};t&&(i.lhnamespace=t);const s=await n.post(i);r.push(...(Object.values(s.query.pages)[0].linkshere||[]).map((({title:e})=>e))),a=s.continue?.lhcontinue}return r},a=async e=>{const t=new mw.Api;let n="";const a=[];for(;void 0!==n;){const r=await t.post({action:"query",prop:"redirects",titles:e,rdlimit:"max",rdcontinue:n});a.push(...(Object.values(r.query.pages)[0].redirects||[]).map((({title:e})=>e))),n=r.continue?.rdcontinue}return a},r=async(e,t=["page","subcat","file"])=>{const n=new mw.Api,a=[];if(mw.config.get("wgUserGroups").some((e=>["bot","flood","patroller","sysop"].includes(e)))){let r="";for(;void 0!==r;){const i=await n.post({action:"query",list:"categorymembers",cmlimit:"max",cmtitle:e,cmtype:t,cmcontinue:r});if(i.query.categorymembers[0])for(const e of i.query.categorymembers)a.push(e.title);r=i.continue?.cmcontinue}}else{const n=async e=>{const r=$(await $.ajax(e)),i=t.map((e=>{switch(e){case"page":return"#mw-pages li a";case"subcat":return"#mw-subcategories li a";case"file":return"#mw-category-media li a.galleryfilename"}})).join(","),s=r.find(i).map(((e,t)=>t.classList.contains("CategoryTreeLabel")?`Category:${$(t).text()}`:t.classList.contains("galleryfilename")?`File:${$(t).text()}`:$(t).text())).get();if(a.push(...s),t.includes("page")){const e=r.find('a[href*="&pagefrom="]');e.length&&await n(e.eq(0).attr("href"))}if(t.includes("subcat")){const e=r.find('a[href*="&subcatfrom="]');e.length&&await n(e.eq(0).attr("href"))}if(t.includes("file")){const e=r.find('a[href*="&filefrom="]');e.length&&await n(e.eq(0).attr("href"))}};await n(`/${e}?action=render`)}return a};var i=n(72),s=n.n(i),o=n(825),c=n.n(o),l=n(659),p=n.n(l),d=n(56),u=n.n(d),m=n(540),f=n.n(m),h=n(113),g=n.n(h),y=n(115),w={};w.styleTagTransform=g(),w.setAttributes=u(),w.insert=p().bind(null,"head"),w.domAPI=c(),w.insertStyleElement=f();s()(y.A,w);y.A&&y.A.locals&&y.A.locals;mw.loader.using(["mediawiki.notification","mediawiki.api"]).done((()=>{let n;const i=(e,t,n="复制成功",a="复制失败")=>{const r=t.text();(async(e="")=>{if("function"==typeof navigator.clipboard?.writeText)await navigator.clipboard.writeText(e);else{const t=document.createElement("input");t.style.position="fixed",t.style.top="-10000px",t.style.zIndex="-999",t.style.opacity="0",document.body.appendChild(t),t.value=e,t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}})(e).then((()=>{t.text(n),setTimeout((()=>t.text(r)),3e3)}),(e=>{t.text(a),mw.notify($(`<span>复制失败: ${e}${e.includes("NotAllowedError")?"<br/>您可能正在使用firefox，或请求响应时间过久，请重新尝试复制。":""}</span>`),{type:"error",autoHideSeconds:"long"}),setTimeout((()=>t.text(r)),3e3)}))},s='<span class="mw-editsection-bracket">[</span>',o='<span class="mw-editsection-bracket">]</span>',c='<span class="mw-editsection-divider"> | </span>',l=mw.config.get("wgNamespaceNumber");if(-1===l){const r=()=>$("#mw-whatlinkshere-list").before($('<span class="listenhancer-linkshere"></span>').append("（",$("<a>复制本页</a>").on("click",(({target:e})=>{const t=$("#mw-whatlinkshere-list>li>a").map(((e,t)=>$(t).text())).get();i(t.join("\n"),$(e))})),$('#mw-content-text a[href*="&from="]').length?" | ":"",$('#mw-content-text a[href*="&from="]').length?$("<a>复制全部</a>").on("click",(async({target:r})=>{if(!n){const r=new URLSearchParams(location.search),i=mw.config.get("wgRelevantPageName"),s=[r.get("hidetrans")?Promise.resolve([]):e(i),r.get("hidelinks")?Promise.resolve([]):t(i),r.get("hideredirs")?Promise.resolve([]):a(i)];await Promise.all(s).then((e=>{const t=[].concat(...e);n=t.join("\n")}))}i(n,$(r))})):"","）")),l=()=>{let e=!0;const t=[],n=$(".search-types li").eq(1),a=n.clone(!1);a.children("a").text("替换空间").attr("title","主、模板等替换常用名字空间").attr("href",((e,t)=>t.replace("profile=images","profile=advanced&limit=500&ns0=1&ns2=1&ns6=1&ns10=1&ns12=1&ns14=1&ns828=1"))),a.insertAfter(n),$("a[data-serp-pos]").each(((e,n)=>{t.push(decodeURIComponent(n.href).replace(/(https:\/\/)?m?zh.moegirl.org.cn\//,"").replace(/_/g," ")),$(n).before(`<a class="listenhancer-search-edit" href="${n.href}?action=edit">[编辑]</a>`)}));const r=$("<a>隐藏详情</a>").on("click",(({target:t})=>{e?($(".searchresult, .mw-search-result-data").hide(),$(".mw-search-results li").css("padding-bottom","0.1em"),$(t).text("显示详情"),e=!1):($(".searchresult, .mw-search-result-data").show(),$(".mw-search-results li").css("padding-bottom",""),$(t).text("隐藏详情"),e=!0)})),l=$("<a>复制列表</a>").on("click",(({target:e})=>{i(t.join("\n"),$(e))}));$("#search .search-types, #powersearch .search-types").append($('<div id="bearbintools-listenhancer-search"></div>').append(s,r,c,l,o)),$(".mw-search-pager-bottom").clone().prependTo($(".searchresults"))};switch(mw.config.get("wgCanonicalSpecialPageName")){case"Whatlinkshere":r();break;case"Search":l()}}else if(14===l){const e=(e,t,a="",l="li a")=>{e.find("h2").append($('<span class="mw-editsection"></span>').append(s,$("<a>复制本页</a>").on("click",(({target:t})=>{i(e.find(l).map(((e,t)=>`${a}${$(t).text()}`)).get().join("\n"),$(t))})),e.children("a").length?c:"",e.children("a").length?$("<a>复制全部</a>").on("click",(async({target:e})=>{if(!n){const e=await r(mw.config.get("wgPageName"),[t]);n=e.join("\n")}i(n,$(e))})):"",o))};e($("#mw-subcategories"),"subcat","Category:"),e($("#mw-pages"),"page"),e($("#mw-category-media"),"file","File:","li a.galleryfilename")}"history"===mw.config.get("wgAction")&&document.getElementById("ca-edit")&&$("#pagehistory>li:not(:first-child)").each(((e,t)=>{const n=$(t).attr("data-mw-revid"),a=mw.config.get("wgScript");$(t).children(".mw-history-undo").children("a:first-child").after(` | <a title="编辑自此版本" href="${a}?action=edit&oldid=${n}&summary=编辑自[[Special:Permanentlink/${n}|版本${n}]]">编辑</a>`),e===$("#pagehistory>li:not(:first-child)").length-1&&$(t).append(`（<span class="mw-history-undo"><a title="编辑自此版本" href="${a}?action=edit&oldid=${n}&summary=编辑自[[Special:Permanentlink/${n}|版本${n}]]">编辑</a></span>）`)}))}))})()})();