{"version":3,"file":"ListEnhancer.min.js","sources":["webpack://bearbin-moegirlpedia/webpack/runtime/rspack_version","webpack://bearbin-moegirlpedia/webpack/runtime/rspack_unique_id","webpack://bearbin-moegirlpedia/./src/utils/api/includeList.ts","webpack://bearbin-moegirlpedia/./src/utils/api/linkList.ts","webpack://bearbin-moegirlpedia/./src/utils/api/redirectList.ts","webpack://bearbin-moegirlpedia/./src/utils/api/categoryMembers.ts","webpack://bearbin-moegirlpedia/./src/utils/clipboard.ts","webpack://bearbin-moegirlpedia/./src/utils/mwElements.ts","webpack://bearbin-moegirlpedia/./src/gadgets/ListEnhancer/index.ts"],"sourcesContent":["__webpack_require__.rv = () => (\"1.4.2\")","__webpack_require__.ruid = \"bundler=rspack@1.4.2\";\n","import type { ApiParams, ApiQueryResponse } from \"@/@types/api\";\n\n/**\n * 获取嵌入了指定页面的页面列表\n * @param pagename 页面名\n * @param tinamespace 命名空间\n * @returns 页面列表\n */\nconst includeList = async (pagename: string, tinamespace?: number[]): Promise<string[]> => {\n  const api = new mw.Api();\n  let ticontinue: string | undefined = undefined;\n  const pageList: string[] = [];\n  const postBody: ApiParams = {\n    action: 'query',\n    prop: 'transcludedin',\n    titles: pagename,\n    tilimit: 'max',\n  };\n  if (tinamespace) {\n    postBody.tinamespace = tinamespace;\n  }\n  do {\n    const res = await api.post(postBody) as ApiQueryResponse;\n    pageList.push(...(Object.values(res.query.pages)[0].transcludedin || []).map(({ title }) => title));\n    ticontinue = res.continue?.ticontinue;\n    if (ticontinue) {\n      postBody.ticontinue = ticontinue;\n    }\n  } while (ticontinue);\n  return pageList;\n};\n\nexport default includeList;\n","import type { ApiParams, ApiQueryResponse } from \"@/@types/api\";\n/**\n * 获取链接到指定页面的列表\n * @param pagename 页面名\n * @param lhnamespace 命名空间，格式同api.php中以|分隔\n * @returns 页面列表\n */\nconst linkList = async (pagename: string, lhnamespace?: number[]): Promise<string[]> => {\n  const api = new mw.Api();\n  let lhcontinue: string | undefined = undefined;\n  const pageList: string[] = [];\n  const postBody: ApiParams = {\n    action: 'query',\n    prop: 'linkshere',\n    titles: pagename,\n    lhlimit: 'max',\n  };\n  if (lhnamespace) {\n    postBody.lhnamespace = lhnamespace;\n  }\n  do {\n    const res = await api.post(postBody) as ApiQueryResponse;\n    pageList.push(...(Object.values(res.query.pages)[0].linkshere || []).map(({ title }) => title));\n    lhcontinue = res.continue?.lhcontinue;\n    if (lhcontinue) {\n      postBody.lhcontinue = lhcontinue;\n    }\n  } while (lhcontinue);\n  return pageList;\n};\n\nexport default linkList;\n","import type { ApiQueryResponse } from '@/@types/api';\n\n/**\n * 获取重定向列表\n * @param pagename 页面名\n * @returns 页面列表\n */\nconst redirectList = async (pagename: string): Promise<string[]> => {\n  const api = new mw.Api();\n  let rdcontinue: string | undefined = '';\n  const pageList: string[] = [];\n  while (rdcontinue !== void 0) {\n    const res = await api.post({\n      action: 'query',\n      prop: 'redirects',\n      titles: pagename,\n      rdlimit: 'max',\n      rdcontinue,\n    }) as ApiQueryResponse;\n    pageList.push(...(Object.values(res.query.pages)[0].redirects || []).map(({ title }) => title));\n    rdcontinue = res.continue?.rdcontinue;\n  }\n  return pageList;\n};\n\nexport default redirectList;\n","import type { Cmtype, ApiQueryResponse } from \"@/@types/api\";\n\n/**\n * 获取分类成员，有权限用户使用api，无权限用户使用ajax。\n *\n * @param cmtitle 分类名\n * @param cmtype 获取类型\n * @returns 页面列表\n */\nconst getCategoryMembers = async (cmtitle: string, cmtype: Cmtype[] = ['page', 'subcat', 'file']) => {\n  const api = new mw.Api();\n  const pageList: string[] = [];\n  // 有api权限的用户通过API获取，无权限用户通过ajax获取\n  if (mw.config.get('wgUserGroups')!.some((group) => ['bot', 'flood', 'patroller', 'sysop'].includes(group))) {\n    let cmcontinue: string | undefined = '';\n    while (cmcontinue !== undefined) {\n      const result = await api.post({\n        action: 'query',\n        format: 'json',\n        utf8: true,\n        list: 'categorymembers',\n        cmlimit: 'max',\n        cmtitle,\n        cmprop: 'title',\n        cmtype,\n        cmcontinue,\n      }) as ApiQueryResponse;\n      if (result.query.categorymembers[0]) {\n        pageList.push(...result.query.categorymembers.map(({ title }) => title));\n      }\n      cmcontinue = result.continue?.cmcontinue;\n    }\n  } else {\n    /**\n     * 对于未持有对应用户组的用户，通过ajax递归获取分类成员\n     * @param {string} link\n     */\n    const getCategoryMembersByAjax = async (link: string) => {\n      const $ajaxResult = $(await $.ajax(link));\n      const selector = cmtype.map((type) => {\n        switch (type) {\n          case 'page':\n            return '#mw-pages li a';\n          case 'subcat':\n            return '#mw-subcategories li a';\n          case 'file':\n            return '#mw-category-media li a.galleryfilename';\n        }\n      }).join(',');\n\n      // 将分类内的页面加入列表\n      const members = $ajaxResult.find(selector).map((_, ele) => {\n        if (ele.classList.contains('CategoryTreeLabel')) {\n          return `Category:${$(ele).text()}`;\n        } else if (ele.classList.contains('galleryfilename')) {\n          return `File:${$(ele).text()}`;\n        }\n        return $(ele).text();\n      }).get();\n      pageList.push(...members);\n\n      // 获取下一页分类内页面\n      if (cmtype.includes('page')) {\n        const $pageContinueLink = $ajaxResult.find('a[href*=\"&pagefrom=\"]');\n        if ($pageContinueLink.length) {\n          await getCategoryMembersByAjax($pageContinueLink.eq(0).attr('href')!);\n        }\n      }\n\n      // 获取下一页子分类\n      if (cmtype.includes('subcat')) {\n        const $catContinueLink = $ajaxResult.find('a[href*=\"&subcatfrom=\"]');\n        if ($catContinueLink.length) {\n          await getCategoryMembersByAjax($catContinueLink.eq(0).attr('href')!);\n        }\n      }\n\n      // 获取下一页分类文件\n      if (cmtype.includes('file')) {\n        const $catContinueLink = $ajaxResult.find('a[href*=\"&filefrom=\"]');\n        if ($catContinueLink.length) {\n          await getCategoryMembersByAjax($catContinueLink.eq(0).attr('href')!);\n        }\n      }\n    };\n\n    await getCategoryMembersByAjax(`/${cmtitle}?useskin=vector&safemode=1`);\n  }\n  return pageList;\n};\n\nexport const traverseCategoryMembers = async (cmtitle: string) => {\n  const traversedCategoryList: string[] = [];\n\n  const traverseCategory = async (category: string) => {\n    const api = new mw.Api();\n    const pageList: string[] = [];\n    let gcmcontinue: string | undefined = '';\n    while (gcmcontinue !== undefined) {\n      const response = await api.post({\n        action: 'query',\n        generator: 'categorymembers',\n        gcmtitle: category,\n        gcmtype: 'page|subcat',\n        gcmlimit: 'max',\n        gcmcontinue,\n      }) as ApiQueryResponse;\n      gcmcontinue = response.continue?.gcmcontinue;\n      for (const { ns, title } of Object.values(response.query.pages)) {\n        if (ns === 14 && !traversedCategoryList.includes(title)) {\n          traversedCategoryList.push(title); // 避免套娃\n          pageList.push(...await traverseCategory(title));\n        } else {\n          pageList.push(title);\n        }\n      }\n      console.log(`\\x1B[4m${category}\\x1B[0m下查找到\\x1B[4m${pageList.length}\\x1B[0m个页面`);\n    }\n    return [...new Set(pageList)];\n  };\n\n  return await traverseCategory(cmtitle);\n};\n\nexport default getCategoryMembers;\n","/** 复制文本到剪贴板 */\r\nconst copyText = async (text = ''): Promise<void> => {\r\n  if (typeof navigator.clipboard?.writeText === 'function') {\r\n    await navigator.clipboard.writeText(text);\r\n  } else {\r\n    const input = document.createElement('input');\r\n    input.style.position = 'fixed';\r\n    input.style.top = '-10000px';\r\n    input.style.zIndex = '-999';\r\n    input.style.opacity = '0';\r\n    document.body.appendChild(input);\r\n    input.value = text;\r\n    input.focus();\r\n    input.select();\r\n    document.execCommand('copy');\r\n    // 创建一个临时元素接收焦点，以供回收input\r\n    const dummyElement = document.createElement('div');\r\n    dummyElement.tabIndex = -1;\r\n    document.body.appendChild(dummyElement);\r\n    dummyElement.focus();\r\n    dummyElement.remove();\r\n    input.remove();\r\n  }\r\n};\r\n\r\n/** 从剪贴板读取文本 */\r\nconst pasteText = async (): Promise<string> => {\r\n  if (navigator.clipboard?.readText) {\r\n    return await navigator.clipboard.readText();\r\n  }\r\n  return new Promise((resolve) => {\r\n    const pasteArea = document.createElement('textarea');\r\n    document.body.appendChild(pasteArea);\r\n    pasteArea.style.position = 'absolute';\r\n    pasteArea.style.top = '0';\r\n    pasteArea.style.zIndex = '-999';\r\n    pasteArea.focus();\r\n    setTimeout(() => {\r\n      const text = pasteArea.value;\r\n      // 创建一个临时元素接收焦点，以供回收pasteArea\r\n      const dummyElement = document.createElement('div');\r\n      dummyElement.tabIndex = -1;\r\n      document.body.appendChild(dummyElement);\r\n      dummyElement.focus();\r\n      dummyElement.remove();\r\n      pasteArea.remove();\r\n      resolve(text);\r\n    }, 0);\r\n  });\r\n};\r\n\r\nexport {\r\n  copyText,\r\n  pasteText,\r\n};\r\n","import createElement from './dom';\n\n/** MediaWiki默认标题编辑按钮区域 */\nexport const editSection = '<span class=\"mw-editsection\"></span>';\n\nexport const bracketStart = '<span class=\"mw-editsection-bracket\">[</span>';\n\nexport const bracketEnd = '<span class=\"mw-editsection-bracket\">]</span>';\n\nexport const divider = '<span class=\"mw-editsection-divider\"> | </span>';\n\n/** 创建一个编辑区元素 */\nexport default function createEditSection(...buttons: (Element | string)[]) {\n  const children: (Element | string)[] = [createElement(bracketStart)];\n  buttons.forEach((button, index) => {\n    children.push(button);\n    if (index < buttons.length - 1) {\n      children.push(createElement(divider));\n    }\n  });\n  children.push(createElement(bracketEnd));\n\n  const section = createElement(editSection) as HTMLSpanElement;\n  section.append(...children);\n  return section;\n}\n","import { categoryMembers, linkList, includeList, redirectList } from '@/utils/api';\r\nimport { copyText } from '@/utils/clipboard';\r\nimport { editSection, bracketStart, bracketEnd, divider } from '@/utils/mwElements';\r\nimport type { Cmtype } from '@/@types/api';\r\nimport styles from './index.inline.less';\r\n\r\nmw.loader.using(['mediawiki.notification', 'mediawiki.api']).done(() => {\r\n  let cacheText: string;\r\n  /**\r\n   * 执行复制操作\r\n   * @param content 要复制的内容\r\n   * @param $element 要改变文字的元素\r\n   * @param successText 复制成功显示的文字\r\n   * @param errorText 复制失败显示的文字\r\n   */\r\n  const copyAction = (content: string, $element: JQuery<HTMLElement>, successText = '复制成功', errorText = '复制失败') => {\r\n    const buttonText = $element.text();\r\n    copyText(content).then(() => {\r\n      $element.text(successText);\r\n      setTimeout(() => $element.text(buttonText), 3000); // 恢复内容\r\n    }, (err) => {\r\n      $element.text(errorText);\r\n      mw.notify($(`<span>复制失败: ${err}${err.includes('NotAllowedError') ? '<br/>您可能正在使用firefox，或请求响应时间过久，请重新尝试复制。' : ''}</span>`), {\r\n        type: 'error',\r\n        autoHideSeconds: 'long',\r\n      });\r\n      setTimeout(() => $element.text(buttonText), 3000);\r\n    });\r\n  };\r\n\r\n  const ns = mw.config.get('wgNamespaceNumber');\r\n\r\n  if (ns === -1) {\r\n    // Special:链入页面\r\n    const linkshereEnhance = () => $('#mw-whatlinkshere-list').before($('<span class=\"listenhancer-linkshere\" />').append(\r\n      '（',\r\n      $('<a>复制本页</a>').on('click', ({ target }) => {\r\n        const anchorList = $('#mw-whatlinkshere-list>li>a').map((_, ele) => $(ele).text()).get(); // 根据标签文本生成列表\r\n        copyAction(anchorList.join('\\n'), $(target));\r\n      }),\r\n      $('#mw-content-text a[href*=\"&from=\"]').length\r\n        ? ' | '\r\n        : '',\r\n      $('#mw-content-text a[href*=\"&from=\"]').length\r\n        ? $('<a>复制全部</a>').on('click', async ({ target }) => {\r\n          // 理论上应该是可以一个请求全部获取，但这样搞简单，以后再改进吧（\r\n          if (!cacheText) {\r\n            const search = new URLSearchParams(location.search);\r\n            const pageName = mw.config.get('wgRelevantPageName');\r\n            const promises = [\r\n              search.get('hidetrans') ? Promise.resolve([]) : includeList(pageName),\r\n              search.get('hidelinks') ? Promise.resolve([]) : linkList(pageName),\r\n              search.get('hideredirs') ? Promise.resolve([]) : redirectList(pageName),\r\n            ];\r\n            await Promise.all(promises).then((results) => {\r\n              const pageList = ([] as string[]).concat(...results); // 二维数组展开为一维\r\n              cacheText = pageList.join('\\n');\r\n            });\r\n          }\r\n          copyAction(cacheText, $(target));\r\n        })\r\n        : '',\r\n      '）',\r\n    ));\r\n\r\n    // Special:搜索\r\n    const searchEnhance = () => {\r\n      $(document.head).append($(`<style>${styles}</style>`));\r\n      let showDetail = true;\r\n      const anchorList: string[] = [];\r\n\r\n      // 复制一个按钮插入到多媒体搜索后面，用于搜索要用于替换的页面\r\n      const $searchMedia = $('.search-types li').eq(1);\r\n      const $nsToReplace = $searchMedia.clone(false);\r\n      $nsToReplace.children('a')\r\n        .text('替换空间')\r\n        .attr('title', '主、模板等替换常用名字空间')\r\n        .attr('href', (_, attr) => attr.replace('profile=images', 'profile=advanced&limit=500&ns0=1&ns2=1&ns6=1&ns10=1&ns12=1&ns14=1&ns828=1')); // 太多了超时，所以500\r\n      $nsToReplace.insertAfter($searchMedia);\r\n\r\n      // 在搜索结果的每个页面后添加编辑按钮，顺带存一个linkList列表用于后续复制列表\r\n      ($('a[data-serp-pos]') as JQuery<HTMLAnchorElement>).each((_, ele) => {\r\n        anchorList.push(decodeURIComponent(ele.href).replace(/(https:\\/\\/)?m?zh.moegirl.org.cn\\//, '').replace(/_/g, ' '));\r\n        $(ele).before(`<a class=\"listenhancer-search-edit\" href=\"${ele.href}?action=edit\">[编辑]</a>`);\r\n      });\r\n\r\n      // 添加详情开关和复制列表按钮\r\n      const $detailToggle = $('<a>隐藏详情</a>').on('click', ({ target }) => {\r\n        if (showDetail) {\r\n          $('.searchresult, .mw-search-result-data').hide(); // 隐藏除标题以外的详情\r\n          $('.mw-search-results li').css('padding-bottom', '0.1em'); // 间距很大，需要控制\r\n          $(target).text('显示详情');\r\n          showDetail = false;\r\n        } else {\r\n          $('.searchresult, .mw-search-result-data').show();\r\n          $('.mw-search-results li').css('padding-bottom', '');\r\n          $(target).text('隐藏详情');\r\n          showDetail = true;\r\n        }\r\n      });\r\n      const $copyList = $('<a>复制列表</a>').on('click', ({ target }) => {\r\n        copyAction(anchorList.join('\\n'), $(target));\r\n      });\r\n\r\n      // 把按钮放到输入条下方的名字空间选择右侧\r\n      $('#search .search-types, #powersearch .search-types').append($('<div id=\"bearbintools-listenhancer-search\" />').append(\r\n        bracketStart,\r\n        $detailToggle,\r\n        divider,\r\n        $copyList,\r\n        bracketEnd,\r\n      ));\r\n\r\n      // 把下方翻页条复制一份到上面\r\n      $('.mw-search-pager-bottom').clone().prependTo($('.searchresults'));\r\n    };\r\n\r\n    // 根据特殊页面进行显示\r\n    switch (mw.config.get('wgCanonicalSpecialPageName')) {\r\n      case 'Whatlinkshere':\r\n        linkshereEnhance();\r\n        break;\r\n      case 'Search':\r\n        searchEnhance();\r\n        break;\r\n    }\r\n  } else if (ns === 14) {\r\n    /**\r\n     * 给对应的标题加上复制按钮及功能\r\n     * @param $element 元素\r\n     * @param type 分类成员类型\r\n     * @param prefix 页面前缀\r\n     * @param linkSelector 成员链接选择器\r\n     */\r\n    const addCopyButton = ($element: JQuery<HTMLElement>, type: Cmtype, prefix = '', linkSelector: JQuery.Selector = 'li a') => {\r\n      $element.find('h2').append(\r\n        $(editSection).append(\r\n          bracketStart,\r\n          $('<a>复制本页</a>').on('click', ({ target }) => {\r\n            copyAction($element.find(linkSelector).map((_, ele) => `${prefix}${$(ele).text()}`).get().join('\\n'), $(target));\r\n          }),\r\n          $element.children('a').length\r\n            ? divider\r\n            : '',\r\n          $element.children('a').length\r\n            ? $('<a>复制全部</a>').on('click', async ({ target }) => {\r\n              if (!cacheText) {\r\n                const pageList = await categoryMembers(mw.config.get('wgPageName'), [type]);\r\n                cacheText = pageList.join('\\n');\r\n              }\r\n              copyAction(cacheText, $(target));\r\n            })\r\n            : '',\r\n          bracketEnd,\r\n        ),\r\n      );\r\n    };\r\n\r\n    // 子分类\r\n    addCopyButton($('#mw-subcategories'), 'subcat', 'Category:');\r\n\r\n    // 分类内页面\r\n    addCopyButton($('#mw-pages'), 'page');\r\n\r\n    // 分类内文件\r\n    addCopyButton($('#mw-category-media'), 'file', 'File:', 'li a.galleryfilename');\r\n  }\r\n  if (mw.config.get('wgAction') === 'history' && document.getElementById('ca-edit')) {\r\n    $('#pagehistory>li:not(:first-child)').each((num, ele) => {\r\n      const oldid = $(ele).attr('data-mw-revid');\r\n      const wgScript = mw.config.get('wgScript');\r\n      $(ele)\r\n        .children('.mw-history-undo')\r\n        .children('a:first-child')\r\n        .after(` | <a title=\"编辑自此版本\" href=\"${wgScript}?action=edit&oldid=${oldid}&summary=编辑自[[Special:Permanentlink/${oldid}|版本${oldid}]]\">编辑</a>`);\r\n      if (num === $('#pagehistory>li:not(:first-child)').length - 1) {\r\n        $(ele).append(`（<span class=\"mw-history-undo\"><a title=\"编辑自此版本\" href=\"${wgScript}?action=edit&oldid=${oldid}&summary=编辑自[[Special:Permanentlink/${oldid}|版本${oldid}]]\">编辑</a></span>）`);\r\n      }\r\n    });\r\n  }\r\n});\r\n"],"names":["includeList","pagename","tinamespace","ticontinue","api","mw","pageList","postBody","res","Object","title","linkList","lhnamespace","lhcontinue","redirectList","rdcontinue","getCategoryMembers","cmtitle","cmtype","group","cmcontinue","undefined","result","getCategoryMembersByAjax","link","$ajaxResult","$","selector","type","members","_","ele","$pageContinueLink","$catContinueLink","copyText","text","navigator","input","document","dummyElement","bracketStart","bracketEnd","divider","cacheText","copyAction","content","$element","successText","errorText","buttonText","setTimeout","err","ns","target","anchorList","search","URLSearchParams","location","pageName","promises","Promise","results","searchEnhance","showDetail","$searchMedia","$nsToReplace","attr","decodeURIComponent","$detailToggle","$copyList","addCopyButton","prefix","linkSelector","categoryMembers","num","oldid","wgScript"],"mappings":"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"}