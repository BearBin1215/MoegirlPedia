{"version":3,"file":"ListEnhancer.min.js","sources":["webpack://bearbin-moegirlpedia/webpack/runtime/rspack_version","webpack://bearbin-moegirlpedia/webpack/runtime/rspack_unique_id","webpack://bearbin-moegirlpedia/./src/utils/api/includeList.ts","webpack://bearbin-moegirlpedia/./src/utils/api/linkList.ts","webpack://bearbin-moegirlpedia/./src/utils/api/redirectList.ts","webpack://bearbin-moegirlpedia/./src/utils/api/categoryMembers.ts","webpack://bearbin-moegirlpedia/./src/utils/clipboard.ts","webpack://bearbin-moegirlpedia/./src/utils/mwElements.ts","webpack://bearbin-moegirlpedia/./src/gadgets/ListEnhancer/index.ts"],"sourcesContent":["__webpack_require__.rv = () => (\"1.4.2\")","__webpack_require__.ruid = \"bundler=rspack@1.4.2\";\n","import type { ApiParams, ApiQueryResponse } from \"@/@types/api\";\r\n\r\n/**\r\n * 获取嵌入了指定页面的页面列表\r\n * @param pagename 页面名\r\n * @param tinamespace 命名空间\r\n * @returns 页面列表\r\n */\r\nconst includeList = async (pagename: string, tinamespace?: number[]): Promise<string[]> => {\r\n  const api = new mw.Api();\r\n  let ticontinue: string | undefined = undefined;\r\n  const pageList: string[] = [];\r\n  const postBody: ApiParams = {\r\n    action: 'query',\r\n    prop: 'transcludedin',\r\n    titles: pagename,\r\n    tilimit: 'max',\r\n  };\r\n  if (tinamespace) {\r\n    postBody.tinamespace = tinamespace;\r\n  }\r\n  do {\r\n    const res = await api.post(postBody) as ApiQueryResponse;\r\n    pageList.push(...(Object.values(res.query.pages)[0].transcludedin || []).map(({ title }) => title));\r\n    ticontinue = res.continue?.ticontinue;\r\n    if (ticontinue) {\r\n      postBody.ticontinue = ticontinue;\r\n    }\r\n  } while (ticontinue);\r\n  return pageList;\r\n};\r\n\r\nexport default includeList;\r\n","import type { ApiParams, ApiQueryResponse } from \"@/@types/api\";\r\n/**\r\n * 获取链接到指定页面的列表\r\n * @param pagename 页面名\r\n * @param lhnamespace 命名空间，格式同api.php中以|分隔\r\n * @returns 页面列表\r\n */\r\nconst linkList = async (pagename: string, lhnamespace?: number[]): Promise<string[]> => {\r\n  const api = new mw.Api();\r\n  let lhcontinue: string | undefined = undefined;\r\n  const pageList: string[] = [];\r\n  const postBody: ApiParams = {\r\n    action: 'query',\r\n    prop: 'linkshere',\r\n    titles: pagename,\r\n    lhlimit: 'max',\r\n  };\r\n  if (lhnamespace) {\r\n    postBody.lhnamespace = lhnamespace;\r\n  }\r\n  do {\r\n    const res = await api.post(postBody) as ApiQueryResponse;\r\n    pageList.push(...(Object.values(res.query.pages)[0].linkshere || []).map(({ title }) => title));\r\n    lhcontinue = res.continue?.lhcontinue;\r\n    if (lhcontinue) {\r\n      postBody.lhcontinue = lhcontinue;\r\n    }\r\n  } while (lhcontinue);\r\n  return pageList;\r\n};\r\n\r\nexport default linkList;\r\n","import type { ApiQueryResponse } from '@/@types/api';\n\n/**\n * 获取重定向列表\n * @param pagename 页面名\n * @returns 页面列表\n */\nconst redirectList = async (pagename: string): Promise<string[]> => {\n  const api = new mw.Api();\n  let rdcontinue: string | undefined = '';\n  const pageList: string[] = [];\n  while (rdcontinue !== void 0) {\n    const body: Record<string, any> = {\n      action: 'query',\n      prop: 'redirects',\n      titles: pagename,\n      rdlimit: 'max',\n    };\n    if (rdcontinue) {\n      body.rdcontinue = rdcontinue;\n    }\n    const res = await api.post(body) as ApiQueryResponse;\n    pageList.push(...(Object.values(res.query.pages)[0].redirects || []).map(({ title }) => title));\n    rdcontinue = res.continue?.rdcontinue;\n  }\n  return pageList;\n};\n\nexport default redirectList;\n","import type { Cmtype, ApiQueryResponse } from \"@/@types/api\";\r\n\r\n/**\r\n * 获取分类成员，有权限用户使用api，无权限用户使用ajax。\r\n *\r\n * @param cmtitle 分类名\r\n * @param cmtype 获取类型\r\n * @returns 页面列表\r\n */\r\nconst getCategoryMembers = async (cmtitle: string, cmtype: Cmtype[] = ['page', 'subcat', 'file']) => {\r\n  const api = new mw.Api();\r\n  const pageList: string[] = [];\r\n  // 有api权限的用户通过API获取，无权限用户通过ajax获取\r\n  if (mw.config.get('wgUserGroups')!.some((group) => ['bot', 'flood', 'patroller', 'sysop'].includes(group))) {\r\n    let cmcontinue: string | undefined = '';\r\n    while (cmcontinue !== undefined) {\r\n      const result = await api.post({\r\n        action: 'query',\r\n        format: 'json',\r\n        utf8: true,\r\n        list: 'categorymembers',\r\n        cmlimit: 'max',\r\n        cmtitle,\r\n        cmprop: 'title',\r\n        cmtype,\r\n        cmcontinue,\r\n      }) as ApiQueryResponse;\r\n      if (result.query.categorymembers[0]) {\r\n        pageList.push(...result.query.categorymembers.map(({ title }) => title));\r\n      }\r\n      cmcontinue = result.continue?.cmcontinue;\r\n    }\r\n  } else {\r\n    /**\r\n     * 对于未持有对应用户组的用户，通过ajax递归获取分类成员\r\n     * @param {string} link\r\n     */\r\n    const getCategoryMembersByAjax = async (link: string) => {\r\n      const $ajaxResult = $(await $.ajax(link));\r\n      const selector = cmtype.map((type) => {\r\n        switch (type) {\r\n          case 'page':\r\n            return '#mw-pages li a';\r\n          case 'subcat':\r\n            return '#mw-subcategories li a';\r\n          case 'file':\r\n            return '#mw-category-media li a.galleryfilename';\r\n        }\r\n      }).join(',');\r\n\r\n      // 将分类内的页面加入列表\r\n      const members = $ajaxResult.find(selector).map((_, ele) => {\r\n        if (ele.classList.contains('CategoryTreeLabel')) {\r\n          return `Category:${$(ele).text()}`;\r\n        } else if (ele.classList.contains('galleryfilename')) {\r\n          return `File:${$(ele).text()}`;\r\n        }\r\n        return $(ele).text();\r\n      }).get();\r\n      pageList.push(...members);\r\n\r\n      // 获取下一页分类内页面\r\n      if (cmtype.includes('page')) {\r\n        const $pageContinueLink = $ajaxResult.find('a[href*=\"&pagefrom=\"]');\r\n        if ($pageContinueLink.length) {\r\n          await getCategoryMembersByAjax($pageContinueLink.eq(0).attr('href')!);\r\n        }\r\n      }\r\n\r\n      // 获取下一页子分类\r\n      if (cmtype.includes('subcat')) {\r\n        const $catContinueLink = $ajaxResult.find('a[href*=\"&subcatfrom=\"]');\r\n        if ($catContinueLink.length) {\r\n          await getCategoryMembersByAjax($catContinueLink.eq(0).attr('href')!);\r\n        }\r\n      }\r\n\r\n      // 获取下一页分类文件\r\n      if (cmtype.includes('file')) {\r\n        const $catContinueLink = $ajaxResult.find('a[href*=\"&filefrom=\"]');\r\n        if ($catContinueLink.length) {\r\n          await getCategoryMembersByAjax($catContinueLink.eq(0).attr('href')!);\r\n        }\r\n      }\r\n    };\r\n\r\n    await getCategoryMembersByAjax(`/${cmtitle}?useskin=vector&safemode=1`);\r\n  }\r\n  return pageList;\r\n};\r\n\r\nexport const traverseCategoryMembers = async (cmtitle: string) => {\r\n  const traversedCategoryList: string[] = [];\r\n\r\n  const traverseCategory = async (category: string) => {\r\n    const api = new mw.Api();\r\n    const pageList: string[] = [];\r\n    let gcmcontinue: string | undefined = '';\r\n    while (gcmcontinue !== undefined) {\r\n      const response = await api.post({\r\n        action: 'query',\r\n        generator: 'categorymembers',\r\n        gcmtitle: category,\r\n        gcmtype: 'page|subcat',\r\n        gcmlimit: 'max',\r\n        gcmcontinue,\r\n      }) as ApiQueryResponse;\r\n      gcmcontinue = response.continue?.gcmcontinue;\r\n      for (const { ns, title } of Object.values(response.query.pages)) {\r\n        if (ns === 14 && !traversedCategoryList.includes(title)) {\r\n          traversedCategoryList.push(title); // 避免套娃\r\n          pageList.push(...await traverseCategory(title));\r\n        } else {\r\n          pageList.push(title);\r\n        }\r\n      }\r\n      console.log(`\\x1B[4m${category}\\x1B[0m下查找到\\x1B[4m${pageList.length}\\x1B[0m个页面`);\r\n    }\r\n    return [...new Set(pageList)];\r\n  };\r\n\r\n  return await traverseCategory(cmtitle);\r\n};\r\n\r\nexport default getCategoryMembers;\r\n","/** 复制文本到剪贴板 */\nconst copyText = async (text = ''): Promise<void> => {\n  if (typeof navigator.clipboard?.writeText === 'function') {\n    await navigator.clipboard.writeText(text);\n  } else {\n    const input = document.createElement('input');\n    input.style.position = 'fixed';\n    input.style.top = '-10000px';\n    input.style.zIndex = '-999';\n    input.style.opacity = '0';\n    document.body.appendChild(input);\n    input.value = text;\n    input.focus();\n    input.select();\n    document.execCommand('copy');\n    // 创建一个临时元素接收焦点，以供回收input\n    const dummyElement = document.createElement('div');\n    dummyElement.tabIndex = -1;\n    document.body.appendChild(dummyElement);\n    dummyElement.focus();\n    dummyElement.remove();\n    input.remove();\n  }\n};\n\n/** 从剪贴板读取文本 */\nconst pasteText = async (): Promise<string> => {\n  if (navigator.clipboard?.readText) {\n    return await navigator.clipboard.readText();\n  }\n  return new Promise((resolve) => {\n    const pasteArea = document.createElement('textarea');\n    document.body.appendChild(pasteArea);\n    pasteArea.style.position = 'absolute';\n    pasteArea.style.top = '0';\n    pasteArea.style.zIndex = '-999';\n    pasteArea.focus();\n    setTimeout(() => {\n      const text = pasteArea.value;\n      // 创建一个临时元素接收焦点，以供回收pasteArea\n      const dummyElement = document.createElement('div');\n      dummyElement.tabIndex = -1;\n      document.body.appendChild(dummyElement);\n      dummyElement.focus();\n      dummyElement.remove();\n      pasteArea.remove();\n      resolve(text);\n    }, 0);\n  });\n};\n\nexport {\n  copyText,\n  pasteText,\n};\n","import createElement from './dom';\r\n\r\n/** MediaWiki默认标题编辑按钮区域 */\r\nexport const editSection = '<span class=\"mw-editsection\"></span>';\r\n\r\nexport const bracketStart = '<span class=\"mw-editsection-bracket\">[</span>';\r\n\r\nexport const bracketEnd = '<span class=\"mw-editsection-bracket\">]</span>';\r\n\r\nexport const divider = '<span class=\"mw-editsection-divider\"> | </span>';\r\n\r\n/** 创建一个编辑区元素 */\r\nexport default function createEditSection(...buttons: (Element | string)[]) {\r\n  const children: (Element | string)[] = [createElement(bracketStart)];\r\n  buttons.forEach((button, index) => {\r\n    children.push(button);\r\n    if (index < buttons.length - 1) {\r\n      children.push(createElement(divider));\r\n    }\r\n  });\r\n  children.push(createElement(bracketEnd));\r\n\r\n  const section = createElement(editSection) as HTMLSpanElement;\r\n  section.append(...children);\r\n  return section;\r\n}\r\n","import { categoryMembers, linkList, includeList, redirectList } from '@/utils/api';\nimport { copyText } from '@/utils/clipboard';\nimport { editSection, bracketStart, bracketEnd, divider } from '@/utils/mwElements';\nimport type { Cmtype } from '@/@types/api';\nimport styles from './index.inline.less';\n\nmw.loader.using(['mediawiki.notification', 'mediawiki.api']).done(() => {\n  let cacheText: string;\n  /**\n   * 执行复制操作\n   * @param content 要复制的内容\n   * @param $element 要改变文字的元素\n   * @param successText 复制成功显示的文字\n   * @param errorText 复制失败显示的文字\n   */\n  const copyAction = (content: string, $element: JQuery<HTMLElement>, successText = '复制成功', errorText = '复制失败') => {\n    const buttonText = $element.text();\n    copyText(content).then(() => {\n      $element.text(successText);\n      setTimeout(() => $element.text(buttonText), 3000); // 恢复内容\n    }, (err) => {\n      $element.text(errorText);\n      mw.notify($(`<span>复制失败: ${err}${err.includes('NotAllowedError') ? '<br/>您可能正在使用firefox，或请求响应时间过久，请重新尝试复制。' : ''}</span>`), {\n        type: 'error',\n        autoHideSeconds: 'long',\n      });\n      setTimeout(() => $element.text(buttonText), 3000);\n    });\n  };\n\n  const ns = mw.config.get('wgNamespaceNumber');\n\n  if (ns === -1) {\n    $(document.head).append($(`<style>${styles}</style>`));\n    // Special:链入页面\n    const linkshereEnhance = () => $('#mw-whatlinkshere-list').before($('<span class=\"listenhancer-linkshere\" />').append(\n      '（',\n      $('<a>复制本页</a>').on('click', ({ target }) => {\n        const anchorList = $('#mw-whatlinkshere-list>li>bdi>a').map((_, ele) => $(ele).text()).get(); // 根据标签文本生成列表\n        copyAction(anchorList.join('\\n'), $(target));\n      }),\n      $('#mw-content-text a.mw-nextlink').length\n        ? ' | '\n        : '',\n      $('#mw-content-text a.mw-nextlink').length\n        ? $('<a>复制全部</a>').on('click', async ({ target }) => {\n          $(target).text('正在读取……');\n          // 理论上应该是可以一个请求全部获取，但这样搞简单，以后再改进吧（\n          if (!cacheText) {\n            const search = new URLSearchParams(location.search);\n            const pageName = mw.config.get('wgRelevantPageName');\n            const promises = [\n              search.get('hidetrans') ? Promise.resolve([]) : includeList(pageName),\n              search.get('hidelinks') ? Promise.resolve([]) : linkList(pageName),\n              search.get('hideredirs') ? Promise.resolve([]) : redirectList(pageName),\n            ];\n            await Promise.all(promises).then((results) => {\n              const pageList = ([] as string[]).concat(...results); // 二维数组展开为一维\n              cacheText = pageList.join('\\n');\n            });\n          }\n          copyAction(cacheText, $(target));\n        })\n        : '',\n      '）',\n    ));\n\n    // Special:搜索\n    const searchEnhance = () => {\n      let showDetail = true;\n      const anchorList: string[] = [];\n\n      // 复制一个按钮插入到多媒体搜索后面，用于搜索要用于替换的页面\n      const $searchMedia = $('.search-types li').eq(1);\n      const $nsToReplace = $searchMedia.clone(false);\n      $nsToReplace.children('a')\n        .text('替换空间')\n        .attr('title', '主、模板等替换常用名字空间')\n        .attr('href', (_, attr) => attr.replace('profile=images', 'profile=advanced&limit=500&ns0=1&ns2=1&ns6=1&ns10=1&ns12=1&ns14=1&ns828=1')); // 太多了超时，所以500\n      $nsToReplace.insertAfter($searchMedia);\n\n      // 在搜索结果的每个页面后添加编辑按钮，顺带存一个linkList列表用于后续复制列表\n      ($('a[data-serp-pos]') as JQuery<HTMLAnchorElement>).each((_, ele) => {\n        anchorList.push(decodeURIComponent(ele.href).replace(/(https:\\/\\/)?m?zh.moegirl.org.cn\\//, '').replace(/_/g, ' '));\n        $(ele).before(`<a class=\"listenhancer-search-edit\" href=\"${ele.href}?action=edit\">[编辑]</a>`);\n      });\n\n      // 添加详情开关和复制列表按钮\n      const $detailToggle = $('<a>隐藏详情</a>').on('click', ({ target }) => {\n        if (showDetail) {\n          $('.searchresult, .mw-search-result-data').hide(); // 隐藏除标题以外的详情\n          $('.mw-search-results li').css('padding-bottom', '0.1em'); // 间距很大，需要控制\n          $(target).text('显示详情');\n          showDetail = false;\n        } else {\n          $('.searchresult, .mw-search-result-data').show();\n          $('.mw-search-results li').css('padding-bottom', '');\n          $(target).text('隐藏详情');\n          showDetail = true;\n        }\n      });\n      const $copyList = $('<a>复制列表</a>').on('click', ({ target }) => {\n        copyAction(anchorList.join('\\n'), $(target));\n      });\n\n      // 把按钮放到输入条下方的名字空间选择右侧\n      $('#search .search-types, #powersearch .search-types').append($('<div id=\"bearbintools-listenhancer-search\" />').append(\n        bracketStart,\n        $detailToggle,\n        divider,\n        $copyList,\n        bracketEnd,\n      ));\n\n      // 把下方翻页条复制一份到上面\n      $('.mw-search-pager-bottom').clone().prependTo($('.searchresults'));\n    };\n\n    // 根据特殊页面进行显示\n    switch (mw.config.get('wgCanonicalSpecialPageName')) {\n      case 'Whatlinkshere':\n        linkshereEnhance();\n        break;\n      case 'Search':\n        searchEnhance();\n        break;\n    }\n  } else if (ns === 14) {\n    /**\n     * 给对应的标题加上复制按钮及功能\n     * @param $element 元素\n     * @param type 分类成员类型\n     * @param prefix 页面前缀\n     * @param linkSelector 成员链接选择器\n     */\n    const addCopyButton = ($element: JQuery<HTMLElement>, type: Cmtype, prefix = '', linkSelector: JQuery.Selector = 'li a') => {\n      $element.find('h2').append(\n        $(editSection).append(\n          bracketStart,\n          $('<a>复制本页</a>').on('click', ({ target }) => {\n            copyAction($element.find(linkSelector).map((_, ele) => `${prefix}${$(ele).text()}`).get().join('\\n'), $(target));\n          }),\n          $element.children('a').length\n            ? divider\n            : '',\n          $element.children('a').length\n            ? $('<a>复制全部</a>').on('click', async ({ target }) => {\n              if (!cacheText) {\n                const pageList = await categoryMembers(mw.config.get('wgPageName'), [type]);\n                cacheText = pageList.join('\\n');\n              }\n              copyAction(cacheText, $(target));\n            })\n            : '',\n          bracketEnd,\n        ),\n      );\n    };\n\n    // 子分类\n    addCopyButton($('#mw-subcategories'), 'subcat', 'Category:');\n\n    // 分类内页面\n    addCopyButton($('#mw-pages'), 'page');\n\n    // 分类内文件\n    addCopyButton($('#mw-category-media'), 'file', 'File:', 'li a.galleryfilename');\n  }\n  if (mw.config.get('wgAction') === 'history' && document.getElementById('ca-edit')) {\n    $('#pagehistory>li:not(:first-child)').each((num, ele) => {\n      const oldid = $(ele).attr('data-mw-revid');\n      const wgScript = mw.config.get('wgScript');\n      $(ele)\n        .children('.mw-history-undo')\n        .children('a:first-child')\n        .after(` | <a title=\"编辑自此版本\" href=\"${wgScript}?action=edit&oldid=${oldid}&summary=编辑自[[Special:Permanentlink/${oldid}|版本${oldid}]]\">编辑</a>`);\n      if (num === $('#pagehistory>li:not(:first-child)').length - 1) {\n        $(ele).append(`（<span class=\"mw-history-undo\"><a title=\"编辑自此版本\" href=\"${wgScript}?action=edit&oldid=${oldid}&summary=编辑自[[Special:Permanentlink/${oldid}|版本${oldid}]]\">编辑</a></span>）`);\n      }\n    });\n  }\n});\n"],"names":["includeList","pagename","tinamespace","ticontinue","api","mw","pageList","postBody","res","Object","title","linkList","lhnamespace","lhcontinue","redirectList","rdcontinue","body","getCategoryMembers","cmtitle","cmtype","group","cmcontinue","undefined","result","getCategoryMembersByAjax","link","$ajaxResult","$","selector","type","members","_","ele","$pageContinueLink","$catContinueLink","copyText","text","navigator","input","document","dummyElement","bracketStart","bracketEnd","divider","cacheText","copyAction","content","$element","successText","errorText","buttonText","setTimeout","err","ns","target","anchorList","search","URLSearchParams","location","pageName","promises","Promise","results","searchEnhance","showDetail","$searchMedia","$nsToReplace","attr","decodeURIComponent","$detailToggle","$copyList","addCopyButton","prefix","linkSelector","categoryMembers","num","oldid","wgScript"],"mappings":"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"}