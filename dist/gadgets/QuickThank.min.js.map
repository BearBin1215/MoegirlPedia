{"version":3,"file":"QuickThank.min.js","sources":["webpack://bearbin-moegirlpedia/webpack/runtime/rspack_version","webpack://bearbin-moegirlpedia/webpack/runtime/rspack_unique_id","webpack://bearbin-moegirlpedia/./src/gadgets/QuickThank/index.ts"],"sourcesContent":["__webpack_require__.rv = () => (\"1.4.2\")","__webpack_require__.ruid = \"bundler=rspack@1.4.2\";\n","/**\n * @description 在特殊页面（最近更改、监视列表、用户贡献等）的编辑历史行添加感谢按钮\n */\n\nif (mw.config.get('wgNamespaceNumber') === -1 && mw.config.get('wgTitle').replace(/.*\\//g, '') !== mw.config.get('wgUserName')) {\n  mw.loader.using(['mediawiki.api', 'oojs-ui']).then(() => {\n    $('.mw-changeslist-line-inner, .mw-enhanced-rc-nested').each((_, ele) => {\n      const $ele = $(ele);\n      const rev = $ele.closest('[data-mw-revid]').attr('data-mw-revid');\n      if (!rev || $ele.find('bdi').text() === mw.config.get('wgUserName')) {\n        return;\n      }\n      const $thankButton = $('<a class=\"quick-thank\">[感谢]</a>') as JQuery<HTMLAnchorElement>;\n      $thankButton.on('click', async (e) => {\n        e.preventDefault();\n        const confirm = await OO.ui.confirm('确定要感谢吗？', {\n          title: '确认',\n          size: 'small',\n        });\n        if (confirm) {\n          $thankButton.html('[感谢<span style=\"display:inline-block;animation:rotate 2s linear infinite;\">↻</span>]');\n          const api = new mw.Api();\n          api.postWithToken('csrf', {\n            format: 'json',\n            action: 'thank',\n            source: 'diff',\n            rev,\n          }).done(() => {\n            $thankButton.text('[感谢成功]');\n            setTimeout(() => {\n              $thankButton.remove();\n            }, 3000);\n          }).fail((err) => {\n            $thankButton.text(`[感谢失败：${err}]`);\n            setTimeout(() => {\n              $thankButton.text('[感谢]');\n            }, 3000);\n          });\n        }\n      });\n      $ele.append($thankButton);\n    });\n  });\n}\n"],"names":["mw","$","_","ele","$ele","rev","$thankButton","e","OO","api","setTimeout","err"],"mappings":"yIAAA,EAAoB,EAAE,CAAG,IAAO,QCAhC,EAAoB,IAAI,CAAG,uBCIvBA,AAAuC,KAAvCA,GAAG,MAAM,CAAC,GAAG,CAAC,sBAA+BA,GAAG,MAAM,CAAC,GAAG,CAAC,WAAW,OAAO,CAAC,QAAS,MAAQA,GAAG,MAAM,CAAC,GAAG,CAAC,eAC/GA,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,gBAAiB,UAAU,EAAE,IAAI,CAAC,KACjDC,EAAE,sDAAsD,IAAI,CAAC,CAACC,EAAGC,KAC/D,IAAMC,EAAOH,EAAEE,GACTE,EAAMD,EAAK,OAAO,CAAC,mBAAmB,IAAI,CAAC,iBACjD,GAAI,CAACC,GAAOD,EAAK,IAAI,CAAC,OAAO,IAAI,KAAOJ,GAAG,MAAM,CAAC,GAAG,CAAC,cACpD,OAEF,IAAMM,EAAeL,EAAE,mCACvBK,EAAa,EAAE,CAAC,QAAS,MAAOC,IAC9BA,EAAE,cAAc,GACA,MAAMC,GAAG,EAAE,CAAC,OAAO,CAAC,UAAW,CAC7C,MAAO,KACP,KAAM,OACR,KAEEF,EAAa,IAAI,CAAC,wFAElBG,AADY,IAAIT,GAAG,GAAG,GAClB,aAAa,CAAC,OAAQ,CACxB,OAAQ,OACR,OAAQ,QACR,OAAQ,OACRK,IAAAA,CACF,GAAG,IAAI,CAAC,KACNC,EAAa,IAAI,CAAC,UAClBI,WAAW,KACTJ,EAAa,MAAM,EACrB,EAAG,IACL,GAAG,IAAI,CAAC,AAACK,IACPL,EAAa,IAAI,CAAC,CAAC,yCAAM,EAAEK,EAAI,CAAC,CAAC,EACjCD,WAAW,KACTJ,EAAa,IAAI,CAAC,OACpB,EAAG,IACL,GAEJ,GACAF,EAAK,MAAM,CAACE,EACd,EACF,E"}