(()=>{"use strict";const e=e=>new Promise(t=>setTimeout(t,e)),t=async(e,t=["page","subcat","file"])=>{const i=new mw.Api,o=[];if(mw.config.get("wgUserGroups").some(e=>["bot","flood","patroller","sysop"].includes(e))){let a="";for(;void 0!==a;){const n=await i.post({action:"query",format:"json",utf8:!0,list:"categorymembers",cmlimit:"max",cmtitle:e,cmprop:"title",cmtype:t,cmcontinue:a});n.query.categorymembers[0]&&o.push(...n.query.categorymembers.map(({title:e})=>e)),a=n.continue?.cmcontinue}}else{const i=async e=>{const a=$(await $.ajax(e)),n=t.map(e=>{switch(e){case"page":return"#mw-pages li a";case"subcat":return"#mw-subcategories li a";case"file":return"#mw-category-media li a.galleryfilename"}}).join(","),s=a.find(n).map((e,t)=>t.classList.contains("CategoryTreeLabel")?`Category:${$(t).text()}`:t.classList.contains("galleryfilename")?`File:${$(t).text()}`:$(t).text()).get();if(o.push(...s),t.includes("page")){const e=a.find('a[href*="&pagefrom="]');e.length&&await i(e.eq(0).attr("href"))}if(t.includes("subcat")){const e=a.find('a[href*="&subcatfrom="]');e.length&&await i(e.eq(0).attr("href"))}if(t.includes("file")){const e=a.find('a[href*="&filefrom="]');e.length&&await i(e.eq(0).attr("href"))}};await i(`/${e}?useskin=vector&safemode=1`)}return o};$(()=>(async()=>{await mw.loader.using(["mediawiki.api"]);const i=new class{data;constructor(e){this.data=e}addPageToList(e,t){const i=[{obj:this.data,path:[]}];for(;i.length>0;){const{obj:o,path:a}=i.shift();for(const[n,s]of Object.entries(o)){if(n===e)return Array.isArray(s)?void s.push(t):void console.error(`${e}ä¸æ˜¯æ•°ç»„ã€‚`);"object"==typeof s&&null!==s&&i.push({obj:s,path:[...a,n]})}}this.data[e]=[t]}get wikitext(){let e=1;const t=["æœ¬é¡µé¢ç”±æœºå™¨äººè‡ªåŠ¨æ›´æ–°ï¼Œå› æ­¤é€šå¸¸ä¸å»ºè®®ç›´æ¥ç¼–è¾‘æœ¬é¡µé¢ã€‚","","æœ€åæ›´æ–°æ—¶é—´ï¼š<u>~~~~~</u>ï¼Œçº¦15åˆ†é’Ÿè¯¯å·®ã€‚","","å¤§å¤šæ•°å†…å®¹å»ºè®®æ‰‹åŠ¨æ’æŸ¥ï¼Œä»¥å…è¯¯åˆ¤ã€‚","","ä¸€äº›å¸¸è§è¯¯åˆ¤è¯¸å¦‚åœ¨éé¡µé¡¶ä½¿ç”¨{{tl|dablink}}ç­‰æƒ…å†µã€‚è‹¥å‡ºç°å…¶ä»–è¯¯åˆ¤ï¼Œè¯·[[User_talk:BearBin|è”ç³»é˜¿ç†Š]]ã€‚","{{ç›®å½•å³ç½®}}"],i=o=>{e++;for(const[a,n]of Object.entries(o))if(t.push("",`${"=".repeat(e)} ${a} ${"=".repeat(e)}`),Array.isArray(n))n.length>0?t.push("{{hide|1=ç‚¹å‡»å±•å¼€åˆ—è¡¨|2=",...n.map(e=>"string"==typeof e?`*[[${e}]]`:`*-{[[${e[0]}]]}-ï¼š${e[1]}`),"}}"):t.push("æš‚æ— ");else{if("object"!=typeof n||null===n)throw new Error(`${a}å¯¹åº”å€¼ç±»å‹æœ‰è¯¯: ${typeof n}`);i(n)}e--};return i(this.data),t.join("\n")}}({æ¶ˆæ­§ä¹‰é¡µä½¿ç”¨ç®¡é“ç¬¦:{åç¼€:[],å‰ç¼€:[]},ç–‘ä¼¼ç¹ä½“é¡µé¢å:[],ä¸ç¤¼è²Œæ’ç‰ˆä¹ æƒ¯:{è¿ç»­æ¢è¡Œ:[],"bigåœ°ç‹±ï¼ˆ5ä¸ªä»¥ä¸Šï¼‰":[],ç–‘ä¼¼å¤§å®¶æ—å‰å•ç‹¬ç”¨äºŒçº§æ ‡é¢˜:[],ç–‘ä¼¼å–Šè¯:[]},å¼ƒç”¨æ ‡ç­¾:{center:[],strike:[],tt:[],font:[]},èƒ½ç”¨å†…é“¾éè¦å¤–é“¾:[],ä¸ç¬¦åˆæ¨¡æ¿è§„èŒƒ:{é‡å¤TOP:[],é¡µé¡¶ç”¨å›¾è¶…è¿‡99px:{æ¡ç›®:[],æ¨¡æ¿:[]},é¡¶éƒ¨æ¨¡æ¿æ’åº:[],æ³¨é‡Šå’Œå¤–éƒ¨é“¾æ¥åçš„å¤§å®¶æ—æ¨¡æ¿:[]},å¤§å®¶æ—nameå‚æ•°æœ‰è¯¯:[],æ¨¡æ¿å¤šä½™æ¢è¡Œ:{ä¸¤ä¸ªæˆ–ä»¥ä¸Š:[],ä¸€ä¸ª:[]},"â€œâ€¢â€å·¦å³å°‘ç©ºæ ¼":{å·¦ä¾§ç¼ºå°‘:[],å³ä¾§ç¼ºå°‘:[]},"ç®¡é“ç¬¦å‰åä¸€è‡´ï¼ˆæ— æ˜æ˜¾å½±å“ï¼Œé€šå¸¸ä¸ç”¨ä¸“é—¨å¤„ç†ï¼‰":{"<nowiki>[[ABC|ABC]]</nowiki>":[],"<nowiki>|ABC{{!}}ABC</nowiki>":[]},æ—§å£°ä¼˜åˆ†ç±»æ ¼å¼:[],"http(s)å°‘å†’å·æˆ–æ–œæ ":[]}),o={prefix:"\\{\\{(?:template:|[æ¨¡æ ·æ¨£]æ¿:|T:)?",navbar:["å°[å¯¼å°]èˆª[æ¡æ¢]","å°[å¯¼å°]èˆª[æ¡æ¢]\\/æ‰¿å‰[å¯å•Ÿ][åå¾Œ]"],disambigTop:["about","not","distinguish","dablink","redirectHere","otheruseslist"],top:["[æ¬¢æ­¡]è¿[ç¼–ç·¨][è¾‘è¼¯]","ä¸å®Œæ•´","æ€¥éœ€æ”¹[è¿›é€²]","[^{|\\[\\]]+top"],disambig:["æ¶ˆæ­§[ä¹‰ç¾©]"],note:["[ç°ç¾][å®å¯¦]äººç‰©"],warn:["æ³•å¾‹å£°æ˜","åŒ»å­¦å£°æ˜","å­¦æœ¯æç¤º","éå®˜æ–¹çŒœæµ‹","æ˜“å¼•å‘è°£è¨€","ç”¨æ¢—é€‚åº¦","è°¨æ…ä½¿ç”¨"],otherNote:["å·²æ•…ç°å®äººç‰©","å·²å®Œç»“","é•¿æœŸå…³æ³¨åŠæ›´æ–°","å«æ—¶é•¿æœŸå…³æ³¨åŠæ›´æ–°","åœæ­¢æ´»åŠ¨","å¼•é€€"],amuse:["é˜¿å¡æ—","è¢«å·¡å›","é»‘å¹•å¯èƒ½æ— æ³•åˆ’å¼€","æš‚æ—¶ä¿ç•™","ä¸€æœ¬æ­£ç»åœ°èƒ¡è¯´å…«é“","å‘"],quote:["cquote","å…ˆä¸€èµ·å–Š"],bottom:["reflist","notelist","NoteFoot","notes","cite","åˆ°èŒå¨˜æ–‡[åº“åº«]","åˆ°[ç»´ç¶­]åŸºç™¾ç§‘","ToWikipedia","åˆ°FANDOM","åˆ°çº³æœ¨ç»´åŸº","åˆ°VNDB","To BWIKI","To 52poke Wiki","To Megami Tensei Wiki","åˆ°ç°[æœºæ©Ÿ]wiki","åˆ°æ³°æ‹‰ç‘[äºšäº]Wiki","åˆ°æ³°æ‹‰ç‘äºšMODWiki","åˆ°MCç™¾ç§‘","åˆ°Minecraft Wiki","åˆ°é­”ç¦[ç»´ç¶­]åŸº","åˆ°THBWiki","åˆ°BlitzHanger","åˆ°å¥³ç¥[è½¬è½‰]ç”Ÿ[ç»´ç¶­]åŸº","To Megami Tensei Wiki","åˆ°MLPä¸­æ–‡[ç»´ç¶­]åŸº","åˆ°PvZ Wiki","å¾®åš","PAGENAME","DEFAULTSORT","#if","#switch","lj\\|","color\\|","ruby\\|","hide\\|","[å‰§åŠ‡]é€","é»‘å¹•","èƒ¡è¯","jk\\|","main\\|","ja\\}","en\\}","zh\\}","zh-hans","zh-hant","lang\\|","cquote","Ps\\|","catn","ColonSort","bilibiliVideo","BV","YoukuVideo","music163","èƒŒæ™¯[å›¾åœ–]ç‰‡","æ›¿[æ¢æ›][ä¾§å´][è¾¹é‚Š][æ æ¬„]åº•[å›¾åœ–]","å¤–éƒ¨[å›¾åœ–]ç‰‡æ³¨[é‡Šé‡‹]","[æ ‡æ¨™][é¢˜é¡Œ]æ›¿[æ¢æ›]","PicHover","Outer[ _]image","pic\\|","disambig","Playlist","æ¶ˆæ­§ä¹‰é¡µ","NoSubpage","noReferer","ç”¨æ¢—é€‚åº¦","ä¸€æœ¬æ­£ç»åœ°èƒ¡è¯´å…«é“","color[ _]block","RoundTop","see also"]};let a;const n=(e,...t)=>((e,t)=>{let i;const o=[];for(;null!==(i=t.exec(e));)o.push(i.index);return o})(e,new RegExp(`${o.prefix}(${t.join("|")})[}\\|\\n]`,"gi")),s=(e,t,o)=>{if(t.includes("Category:æ¶ˆæ­§ä¹‰é¡µ")){const t=e.match(/\[\[(.+)\(.+\)\|\1\]\].*â€”/),a=e.match(/\[\[[^:\n].*:(.+)\|\1\]\].*â€”/);t?i.addPageToList("åç¼€",[o,`<code><nowiki>${t[0].replaceAll("â€”","")}</nowiki></code>`]):a&&i.addPageToList("å‰ç¼€",[o,`<code><nowiki>${a[0].replaceAll("â€”","")}</nowiki></code>`])}},r=(e,t,o)=>{t.some(e=>e.includes("éŸ³ä¹ä½œå“"))||(/(<br *\/ *>\s*){4,}/i.test(e)||/(\n|<br *\/? *>){8}/i.test(e))&&i.addPageToList("è¿ç»­æ¢è¡Œ",o)},c=(e,t,o)=>{/(<big>){5}/i.test(e)&&i.addPageToList("bigåœ°ç‹±ï¼ˆ5ä¸ªä»¥ä¸Šï¼‰",o)},l=(e,t,a)=>{new RegExp(`${o.prefix}(èƒŒæ™¯[å›¾åœ–]ç‰‡|æ›¿[æ¢æ›][ä¾§å´][è¾¹é‚Š][æ æ¬„]åº•[å›¾åœ–])[^}]+img\\.moegirl\\.org\\.cn`,"si").test(e)&&"Deltarune/é»‘æš—ä¸–ç•Œ"!==a&&i.addPageToList("èƒ½ç”¨å†…é“¾éè¦å¤–é“¾",a)},g=(e,t,a)=>{new RegExp(`== *(ç›¸å…³|æ›´å¤š|å…¶ä»–|å…¶å®ƒ)(æ¡ç›®|æ¢ç›®|å†…å®¹|é“¾æ¥)? *==\n*${o.prefix}((?!${o.bottom.join("|")}).)*\\}`,"gi").test(e)&&i.addPageToList("ç–‘ä¼¼å¤§å®¶æ—å‰å•ç‹¬ç”¨äºŒçº§æ ‡é¢˜",a)},d=(e,t,a)=>{new RegExp(`== *(è„šæ³¨|[æ³¨è¨»]è§£|æ³¨é‡Š|è¨»é‡‹|å¤–éƒ¨[é“¾éˆ]æ¥|å¤–éƒ¨é€£çµ|å¤–é“¾|[å‚åƒ]è€ƒ).*==[\\s\\S]*\n${o.prefix}((?!${o.bottom.join("|")}).)*\\}`,"gi").test(e)&&i.addPageToList("æ³¨é‡Šå’Œå¤–éƒ¨é“¾æ¥åçš„å¤§å®¶æ—æ¨¡æ¿",a)},p=(e,t,o)=>{(/\{\{color\|red\|'''[^}|]{50,}'''\}\}/i.test(e)||/'''\{\{color\|red\|[^}|]{50,}\}\}'''/i.test(e))&&i.addPageToList("ç–‘ä¼¼å–Šè¯",o)},u=(e,t,n)=>{const s=new RegExp(`${o.prefix}(${o.top.join("|")})[}\\|\\n]`,"gi"),r=e.match(s)||[];let c=0;for(const e of r)a.includes(e.replace(s,"$1"))&&c++;c>1&&i.addPageToList("é‡å¤TOP",n)},m=(e,t,o)=>{(/leftimage *=[.\n]*\d{3}px/.test(e)||/\{\{(?:template:|[æ¨¡æ ·æ¨£]æ¿:|T:)?(æ¬¢è¿ç¼–è¾‘|æ­¡è¿ç·¨è¼¯|ä¸å®Œæ•´|customtop).*\d{3}px/i.test(e))&&i.addPageToList("æ¡ç›®",o)},f=(e,t,a)=>{const s={æ¶ˆæ­§ä¹‰å¯¼èˆªæ¨¡æ¿:n(e,...o.disambigTop),ä¸“é¢˜å¯¼èˆªå¯¼èˆª:n(e,"å¯¼èˆª"),å¯¼èˆªæ¡:n(e,...o.navbar),"{{tl|æ¶ˆæ­§ä¹‰}}":n(e,...o.disambig),æ¬¢è¿ç¼–è¾‘æˆ–ä¸“é¢˜TOP:n(e,...o.top),æç¤ºæ¨¡æ¿:n(e,...o.note),å¨±ä¹æ¨¡æ¿:n(e,...o.amuse),å–Šè¯æ¨¡æ¿:n(e,...o.quote)},r=(e=>{for(let t=0;t<e.length-1;t++){const i=Math.max(...e[t].filter(e=>e<=600));for(let o=t+1;o<e.length;o++)if(i>=Math.min(...e[o].filter(e=>e<=600)))return o}return 0})(Object.values(s));r>0&&i.addPageToList("é¡¶éƒ¨æ¨¡æ¿æ’åº",[a,`<code>${Object.keys(s)[r]}</code>`])},w=(e,t,o)=>{t.includes("Category:é¡µé¡¶æç¤ºæ¨¡æ¿")&&(/leftimage *=.*\d{3}px/.test(e)||/(width|size) *= *\d{3}px/.test(e)||/\[\[(File|Image):[^\]]+\| *\d{3}px/i.test(e))&&i.addPageToList("æ¨¡æ¿",o)},h=(e,t,o)=>{t.some(e=>["Category:æ¨¡æ¿æ–‡æ¡£","Category:æ¡ç›®æ ¼å¼æ¨¡æ¿","Category:æƒé™ç”³è¯·æ¨¡æ¿"].includes(e))||(/(\n{2,}<noinclude>|<\/noinclude>\n{2,}[^|]|<includeonly>\n{2,}|\n{2,}<\/includeonly>)/.test(e)?i.addPageToList("ä¸¤ä¸ªæˆ–ä»¥ä¸Š",o):/(\n<noinclude>|<\/noinclude>\n|<includeonly>\n|\n<\/includeonly>)/.test(e)&&i.addPageToList("ä¸€ä¸ª",o))},k=(e,t,o)=>{if(t.includes("Category:ç”¨æˆ·ç¼–è¾‘ç»„æ¨¡æ¿"))return;const a=e.match(/([^\]\n]+\]\]|[^}\n]+\}\})â€¢/),n=e.match(/â€¢(\[\[[^\]\n]+|\{\{[^}\n]+)/);a&&i.addPageToList("å·¦ä¾§ç¼ºå°‘",[o,`<code><nowiki>${a[0]}</nowiki></code>`]),n&&i.addPageToList("å³ä¾§ç¼ºå°‘",[o,`<code><nowiki>${n[0]}</nowiki></code>`])},y=(e,t,o)=>{const a=e.match(/\[\[ *([^\]]+) *\| *\1 *\]\]/),n=e.match(/\| *([^\]{}}]+) *\{\{!\}\} *\1 *(\||\})/);a&&i.addPageToList("<nowiki>[[ABC|ABC]]</nowiki>",[o,`<code><nowiki>${a[0]}</nowiki></code>`]),n&&i.addPageToList("<nowiki>|ABC{{!}}ABC</nowiki>",[o,`<code><nowiki>${n[0]}</nowiki></code>`])},b=(e,t,o)=>{const a=e.match(/\|å¤šä½(é…éŸ³|å£°ä¼˜) *= *\{\{cate\|[^{}|]+\|[^{}[\]\n]+[^è‰²{}[\]\n](\}\}|\|)/gi);a&&i.addPageToList("æ—§å£°ä¼˜åˆ†ç±»æ ¼å¼",[o,`<code><nowiki>${a[0]}</nowiki></code>`])},$=(e,t,o)=>{const a=e.match(/\| *name *= *[^|\n]*/gi)||[];if(!t.includes("Category:æ¨¡æ¿æ–‡æ¡£")&&e.match(/\{\{ *(?:#invoke:|Template:|T:|æ¨¡æ¿:|æ ·æ¿:)? *(å¤§å®¶æ—|Nav)/gi)&&!/:(æ²™ç›’|Sandbox|Navbox|å¤§å®¶æ—$)/.test(o)&&a)for(const e of a)if(e.replace(/\| *name *= *([^|\n]*)/g,"$1").replaceAll("_"," ").trim().toLowerCase()!==o.replace("Template:","").toLowerCase())return void i.addPageToList("å¤§å®¶æ—nameå‚æ•°æœ‰è¯¯",[o,`<code><nowiki>${e}</nowiki></code>`])},T=(e,t,o)=>{const a=e.match(/[^/]https?(\/\/|:\/[a-zA-Z0-9])/gi);a&&i.addPageToList("http(s)å°‘å†’å·æˆ–æ–œæ ",[o,`<code><nowiki>${a[0]}</nowiki></code>`])},x=(e,t,o)=>{const a=[{tag:"center",regex:/<(center)(?:\s[^>]*)?>|<\/center>/gi},{tag:"tt",regex:/<(tt)(?:\s[^>]*)?>|<\/tt>/gi},{tag:"strike",regex:/<(strike)(?:\s[^>]*)?>|<\/strike>/gi},{tag:"font",regex:/<(font)(?:\s[^>]*)?>|<\/font>/gi}];for(const{tag:t,regex:n}of a){const a=e.match(n);a&&i.addPageToList(t,[o,`<code><nowiki>${a[0]}</nowiki></code>`])}},P=new mw.Api,L=async(t,i=0,o=10,a=500)=>{let n={},s=!1;const r=e=>{for(const{title:t,revisions:i,categories:o}of e)n[t]||={categories:[],text:i?.[0]?.["*"]?.replace(/<!--[\s\S]*?-->/g,"")||""},i?.length>0&&0,o&&n[t].categories.push(...o.map(e=>e.title))},c={action:"query",generator:"allpages",gaplimit:a,cllimit:"max",gapnamespace:i,prop:"revisions|categories",rvprop:"content",utf8:!0},l=async(t,i)=>{s||(s=!0),console.error(`è¯·æ±‚å‡ºé”™ï¼š${t}ï¼Œè¯·æ±‚å‚æ•°ï¼š${JSON.stringify(c)}ï¼Œå³å°†é‡è¯•(${i}/${o})`),c.gaplimit=Math.ceil(c.gaplimit/2),await e(3e3)};await e(7e3);do{let e;n={};let i=0;for(;i<o;)try{e=await P.post(c);break}catch(e){await l(e,++i)}s=!1,c.gaplimit=Math.min(2*c.gaplimit,a),r(Object.values(e.query.pages));let{gapcontinue:g,rvcontinue:d,clcontinue:p}=e.continue||{};for(;d||p;){let e;for(d&&(c.rvcontinue=d),p&&(c.clcontinue=p),i=0;i<o;)try{e=await P.post(c);break}catch(e){await l(e,++i)}if(s=!1,c.gaplimit=Math.min(2*c.gaplimit,a),r(Object.values(e.query.pages)),e.continue?.gapcontinue){({gapcontinue:g}=e.continue),Reflect.deleteProperty(c,"rvcontinue"),Reflect.deleteProperty(c,"clcontinue");break}let t=!1;if(e.continue?.rvcontinue&&(({rvcontinue:d}=e.continue),t=!0),e.continue?.clcontinue&&(({clcontinue:p}=e.continue),t=!0),!t)break}c.gapcontinue=g;for(const[e,{text:i,categories:o}]of Object.entries(n))for(const a of t)a(i,o,e)}while(void 0!==c.gapcontinue)},v=async(e=0)=>{let t="",o=0;do{if(o>=10)throw new Error("è·å–ç–‘ä¼¼ç¹ä½“é¡µé¢åå°è¯•æ¬¡æ•°è¿‡å¤šã€‚");try{const o=await P.post({action:"query",format:"json",prop:"info",generator:"allpages",inprop:"varianttitles",gapfilterredir:"nonredirects",gaplimit:"max",gapnamespace:e,gapcontinue:t});t=o.continue?.gapcontinue;for(const{title:e,varianttitles:{"zh-cn":t}}of Object.values(o.query.pages))/[ã-ã‚“ã‚¡-ãƒ¶]/.test(e)||e.replace(/^(?:Category|Template):/,"")===t.replace(/^(?:åˆ†ç±»|æ¨¡æ¿):/,"")||i.addPageToList("ç–‘ä¼¼ç¹ä½“é¡µé¢å",[`:${e}`,`â†’${t}`])}catch(e){o++}}while(t)};(async()=>{a=(await t("Category:é¡µé¡¶æç¤ºæ¨¡æ¿")).map(e=>e.replace("Template:","")).filter(e=>!["æ¶ç©ºå†å²"].includes(e)),await L([s,r,c,u,m,p,g,d,f,l,y,b,T,x],0,20),await L([w,h,k,y,$,x],10,10),await v(0),await v(10),await v(14),await(async(t=5)=>{const o="User:BearBin/æ‚ç‰©";let a=0;for(;a<t;)try{return void await P.postWithToken("csrf",{action:"edit",title:o,summary:"è‡ªåŠ¨æ›´æ–°åˆ—è¡¨",text:i.wikitext,bot:!0,tags:"Bot"})}catch(i){console.error(`ä¿å­˜å‡ºé”™ï¼š${i}ï¼Œå³å°†é‡è¯•(${++a}/${t})`),await e(3e3)}throw new Error(`ä¿å­˜åˆ°[4m${o}[0må¤±è´¥ã€‚`)})()})()})())})();